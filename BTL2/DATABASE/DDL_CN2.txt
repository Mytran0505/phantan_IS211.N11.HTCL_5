LOAD CSV WITH HEADERS FROM 'file:///EMPLOYEE_2.csv' AS row
CREATE (E:EMPLOYEE)
SET E = row,
E.EMP_ID = toInteger(row.EMP_ID),
E.BIRTHDAY = Date(row.BIRTHDAY),
E.START_DATE = Date(row.START_DATE),
E.SALARY = toInteger(row.SALARY)

LOAD CSV WITH HEADERS FROM 'file:///BRANCH_2.csv' AS row
CREATE (B:BRANCH)
SET B = row

LOAD CSV WITH HEADERS FROM 'file:///BILL_2.csv' AS row
CREATE (B:BILL)
SET B = row,
B.BILL_ID = toInteger(row.BILL_ID),
B.EMP_ID = toInteger(row.EMP_ID),
B.CUS_ID = toInteger(row.CUS_ID),
B.BILL_DATE = Date(row.BILL_DATE),
B.TOTAL_MONEY = toInteger(row.TOTAL_MONEY)

LOAD CSV WITH HEADERS FROM 'file:///BILL_DETAILS_2.csv' AS row
CREATE (BD:BILL_DETAILS)
SET BD = row,
BD.BILL_ID = toInteger(row.BILL_ID),
BD.PRO_ID = toInteger(row.PRO_ID),
BD.AMOUNT = toInteger(row.AMOUNT)

LOAD CSV WITH HEADERS FROM 'file:///CUSTOMER_2.csv' AS row
CREATE (C:CUSTOMER)
SET C = row,
C.CUS_ID = toInteger(row.CUS_ID),
C.BIRTHDAY = Date(row.BIRTHDAY),
C.REG_DATE = Date(row.REG_DATE),
C.SPENT_MONEY = toInteger(row.SPENT_MONEY),
C.POINT = toInteger(row.POINT)

LOAD CSV WITH HEADERS FROM 'file:///PRODUCT_2.csv' AS row
CREATE (P:PRODUCT)
SET P = row,
P.PRO_ID = toInteger(row.PRO_ID),
P.ORIGINAL_PRICE = toInteger(row.ORIGINAL_PRICE),
P.SALE_PRICE = toInteger(row.SALE_PRICE),
P.MFG = Date(row.MFG),
P.EXP = Date(row.EXP),
P.VAT = toInteger(row.VAT),
P.REMAINING_QUANTITY = toInteger(row.REMAINING_QUANTITY)


LOAD CSV WITH HEADERS FROM 'file:///WAREHOUSE_MANAGEMENT_2.csv' AS row
CREATE (WM:WAREHOUSE_MANAGEMENT)
SET WM = row,
WM.PRO_ID = toInteger(row.PRO_ID),
WM.IMPORTED_DATE = Date(row.IMPORTED_DATE),
WM.IMPORTED_QUANTITY = toInteger(row.IMPORTED_QUANTITY)


LOAD CSV WITH HEADERS FROM 'file:///WAREHOUSE_SALES_2.csv' AS row
CREATE (WS:WAREHOUSE_SALES)
SET WS = row,
WS.PRO_ID = toInteger(row.PRO_ID)

CREATE CONSTRAINT FOR (B: BRANCH) REQUIRE B.BRANCH_ID IS UNIQUE;
CREATE CONSTRAINT FOR (C: CUSTOMER) REQUIRE C.CUS_ID IS UNIQUE;
CREATE CONSTRAINT FOR (B: BILL) REQUIRE B.BILL_ID IS UNIQUE;
CREATE CONSTRAINT FOR (BD: BILL_DETAILS) REQUIRE (BD.BILL_ID, BD.PRO_ID) IS UNIQUE;
CREATE CONSTRAINT FOR (E: EMPLOYEE) REQUIRE E.EMP_ID IS UNIQUE;
CREATE CONSTRAINT FOR (P: PRODUCT) REQUIRE P.PRO_ID IS UNIQUE;
CREATE CONSTRAINT FOR (WM: WAREHOUSE_MANAGEMENT) REQUIRE (WM.BRANCH_ID, WM.PRO_ID) IS UNIQUE;
CREATE CONSTRAINT FOR (WS: WAREHOUSE_SALES) REQUIRE (WS.BRANCH_ID, WS.PRO_ID) IS UNIQUE;

MATCH(E:EMPLOYEE),(B:BRANCH) WHERE E.BRANCH_ID = B.BRANCH_ID CREATE (E) -[R:FK_EMP_BRANCH] -> (B)
MATCH(WH:WAREHOUSE_MANAGEMENT),(B:BRANCH) WHERE WH.BRANCH_ID = B.BRANCH_ID CREATE (WH) -[R:FK_WM_BRANCH] -> (B)
MATCH(WH:WAREHOUSE_MANAGEMENT),(P:PRODUCT) WHERE WH.PRO_ID = P.PRO_ID CREATE (WH) -[R:FK_WM_PRO] -> (P)
MATCH(WS:WAREHOUSE_SALES),(B:BRANCH) WHERE WS.BRANCH_ID = B.BRANCH_ID CREATE (WS) -[R:FK_WS_BRANCH] -> (B)
MATCH(WS:WAREHOUSE_SALES),(P:PRODUCT) WHERE WS.PRO_ID = P.PRO_ID CREATE (WS) -[R:FK_WS_PRO] -> (P)
MATCH(B:BILL),(E:EMPLOYEE) WHERE B.EMP_ID = E.EMP_ID CREATE (B) -[R:FK_BILL_EMP] -> (E)
MATCH(B:BILL),(C:CUSTOMER) WHERE B.CUS_ID = C.CUS_ID CREATE (B) -[R:FK_BILL_CUS] -> (C)
MATCH(BD:BILL_DETAILS),(B:BILL) WHERE BD.BILL_ID = B.BILL_ID CREATE (BD) -[R:FK_B_DETAILS_BILL] -> (B)
MATCH(BD:BILL_DETAILS),(P:PRODUCT) WHERE BD.PRO_ID = P.PRO_ID CREATE (BD) -[R:FK_B_DETAILS_PRO] -> (P)